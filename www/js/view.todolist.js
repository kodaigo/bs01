// Generated by CoffeeScript 1.4.0
(function() {

  define(['zepto', 'underscore', 'backbone'], function($, _, Backbone) {
    var TodoView;
    TodoView = Backbone.View.extend({
      tagName: 'div',
      className: 'task',
      template: _.template($("#tmpl-task").html()),
      events: {
        "click .title a": "showDetail",
        "click .close a": "hideDetail",
        "click .complete a": "clear",
        "click .edit a": "edit"
      },
      initialize: function() {
        this.listenTo(this.model, 'change', this.render);
        this.listenTo(this.model, 'destroy', this.remove);
      },
      render: function() {
        this.$el.html(this.template(this.model.toJSON()));
        this.$el.toggleClass('done', this.model.get('done'));
        this.elDetail = this.$('.detail');
        return this;
      },
      toggleDone: function() {
        this.model.doggle();
      },
      clear: function(e) {
        var _this = this;
        this.$el.animate({
          marginLeft: "100%"
        }, 300, 'swing', function() {
          _this.$el.animate({
            height: 0,
            marginTop: 0
          }, 300, 'swing', function() {
            _this.model.destroy();
            return app.layout.refresh();
          });
        });
        return false;
      },
      showDetail: function(e) {
        this.elDetail.show();
        app.layout.refresh();
        return false;
      },
      hideDetail: function(e) {
        this.elDetail.hide();
        app.layout.refresh();
        return false;
      },
      edit: function() {
        return this.$el.addClass("editing");
      }
    });
    return TodoView;
  });

}).call(this);
